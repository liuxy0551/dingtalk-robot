var e=Object.defineProperty,o=Object.defineProperties,n=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,l=(o,n,t)=>n in o?e(o,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[n]=t;import{a as i}from"./index.beabc6ba.js";import{q as d,o as c,t as r,T as m,r as y,c as f,e as p,F as I,s as u,w as g,p as C,a as b,b as h,v,d as j,f as w}from"./vendor.da1435fe.js";const k={setup(){const e=localStorage.getItem("senderId"),y=localStorage.getItem("moneyInfoCodes"),f=d({typeConfirmVisible:!1,typeActions:[{name:"基金",value:"jijin"},{name:"股票",value:"gupiao"}],moneyInfo:null,keyword:"",result:[],moneyInfoCodeList:[]});c((()=>{y&&(f.moneyInfoCodeList=y.split(","))}));return p=((e,o)=>{for(var n in o||(o={}))a.call(o,n)&&l(e,n,o[n]);if(t)for(var n of t(o))s.call(o,n)&&l(e,n,o[n]);return e})({senderId:e},r(f)),o(p,n({onSearch:e=>{i.get(`https://suggest3.sinajs.cn/suggest/key=${encodeURI(e)}&name=callbackCode`).then((e=>{if(e.split(";")[0].length<25)return m("查无结果");let o=[];e.split(";").forEach((e=>{e=e.split(","),o.push({code:e[3],codeB:e[2],name:e[6],selected:f.moneyInfoCodeList.includes(e[2])||f.moneyInfoCodeList.includes(e[3]),loading:!1})})),f.result=o}))},showConfirm:e=>{f.moneyInfo=e,f.typeConfirmVisible=!0},createMoneyInfo:o=>{f.moneyInfo.loading=!0;const n={senderId:e,type:o.value,name:f.moneyInfo.name,code:f.moneyInfo["jijin"===o.value?"codeB":"code"],sort:f.moneyInfoCodeList.length};i.post("/api/createMoneyInfo",n).then((()=>{f.moneyInfoCodeList.push(n.code),localStorage.setItem("moneyInfoCodes",f.moneyInfoCodeList.join(",")),m("添加成功"),f.moneyInfo.selected=!0})).finally((()=>{f.moneyInfo.loading=!1}))},deleteMoneyInfo:o=>{const n=f.moneyInfoCodeList.some((e=>e===o.code));o.loading=!0;const t={senderId:e,code:o[n?"code":"codeB"]};i.post("/api/deleteMoneyInfo",t).then((()=>{f.moneyInfoCodeList.splice(f.moneyInfoCodeList.indexOf(o[n?"code":"codeB"]),1),localStorage.setItem("moneyInfoCodes",f.moneyInfoCodeList.join(",")),m("删除成功"),o.selected=!1})).finally((()=>{o.loading=!1}))}}));var p}},S=g();C("data-v-08f5c1b5");const L={class:"money-content"},O={class:"top-search"},V={class:"box"},x={key:0,class:"row"},M={class:"text"},P=w("添加自选"),B=w("删除自选");b();const U=S(((e,o,n,t,a,s)=>{const l=y("van-search"),i=y("van-button"),d=y("van-action-sheet");return h(),f("div",L,[p("div",O,[p(l,{modelValue:e.keyword,"onUpdate:modelValue":[o[1]||(o[1]=o=>e.keyword=o),t.onSearch],placeholder:"请输入简称/拼音/代码",onSearch:t.onSearch},null,8,["modelValue","onSearch","onUpdate:modelValue"])]),p("div",V,[(h(!0),f(I,null,u(e.result,(e=>(h(),f("div",{class:"item",key:e.code},[e.code&&e.name?(h(),f("div",x,[p("div",M,v(e.code)+" - "+v(e.name),1),e.selected?(h(),f(i,{key:1,type:"warning",size:"mini",loading:e.loading,onClick:o=>t.deleteMoneyInfo(e)},{default:S((()=>[B])),_:2},1032,["loading","onClick"])):(h(),f(i,{key:0,type:"primary",size:"mini",loading:e.loading,onClick:o=>t.showConfirm(e)},{default:S((()=>[P])),_:2},1032,["loading","onClick"]))])):j("",!0)])))),128))]),p(d,{show:e.typeConfirmVisible,"onUpdate:show":o[2]||(o[2]=o=>e.typeConfirmVisible=o),actions:e.typeActions,"cancel-text":"取消","close-on-click-action":"",onSelect:t.createMoneyInfo,title:"选择理财类型"},null,8,["show","actions","onSelect"])])}));k.render=U,k.__scopeId="data-v-08f5c1b5";export default k;
