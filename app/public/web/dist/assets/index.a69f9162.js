var e=Object.defineProperty,o=Object.defineProperties,n=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,l=(o,n,t)=>n in o?e(o,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[n]=t;import{a as i}from"./index.6b4cf0cd.js";import{n as d,k as c,t as r,m as f,r as m,c as y,b as p,F as I,q as u,w as g,p as C,a as h,o as b,s as v,v as j,d as k}from"./vendor.5f407378.js";const w={setup(){const e=localStorage.getItem("senderId"),m=localStorage.getItem("moneyInfoCodes"),y=d({typeConfirmVisible:!1,typeActions:[{name:"基金",value:"jijin"},{name:"股票",value:"gupiao"}],moneyInfo:null,keyword:"",result:[],moneyInfoCodeList:[]});c((()=>{m&&(y.moneyInfoCodeList=m.split(","))}));return p=((e,o)=>{for(var n in o||(o={}))s.call(o,n)&&l(e,n,o[n]);if(t)for(var n of t(o))a.call(o,n)&&l(e,n,o[n]);return e})({senderId:e},r(y)),o(p,n({onSearch:e=>{i.get(`http://suggest3.sinajs.cn/suggest/key=${e}&name=callbackCode`).then((e=>{if(e.split(";")[0].length<25)return f("查无结果");let o=[];e.split(";").forEach((e=>{e=e.split(","),o.push({code:e[3],codeB:e[2],name:e[6],selected:y.moneyInfoCodeList.includes(e[2])||y.moneyInfoCodeList.includes(e[3]),loading:!1})})),y.result=o}))},showConfirm:e=>{y.moneyInfo=e,y.typeConfirmVisible=!0},createMoneyInfo:o=>{y.moneyInfo.loading=!0;const n={senderId:e,type:o.value,name:y.moneyInfo.name,code:y.moneyInfo["jijin"===o.value?"codeB":"code"],sort:y.moneyInfoCodeList.length};i.post("/api/createMoneyInfo",n).then((()=>{y.moneyInfoCodeList.push(n.code),localStorage.setItem("moneyInfoCodes",y.moneyInfoCodeList.join(",")),f("添加成功"),y.moneyInfo.selected=!0})).finally((()=>{y.moneyInfo.loading=!1}))},deleteMoneyInfo:o=>{const n=y.moneyInfoCodeList.some((e=>e===o.code));o.loading=!0;const t={senderId:e,code:o[n?"code":"codeB"]};i.post("/api/deleteMoneyInfo",t).then((()=>{y.moneyInfoCodeList.splice(y.moneyInfoCodeList.indexOf(o[n?"code":"codeB"]),1),localStorage.setItem("moneyInfoCodes",y.moneyInfoCodeList.join(",")),f("删除成功"),o.selected=!1})).finally((()=>{o.loading=!1}))}}));var p}},L=g();C("data-v-59bd4ff9");const S={class:"money-content"},O={class:"top-search"},V={class:"box"},x={key:0,class:"row"},M={class:"text"},P=k("添加自选"),B=k("删除自选");h();const _=L(((e,o,n,t,s,a)=>{const l=m("van-search"),i=m("van-button"),d=m("van-action-sheet");return b(),y("div",S,[p("div",O,[p(l,{modelValue:e.keyword,"onUpdate:modelValue":o[1]||(o[1]=o=>e.keyword=o),placeholder:"请输入简称/拼音/代码",onSearch:t.onSearch},null,8,["modelValue","onSearch"])]),p("div",V,[(b(!0),y(I,null,u(e.result,(e=>(b(),y("div",{class:"item",key:e.code},[e.code&&e.name?(b(),y("div",x,[p("div",M,v(e.code)+" - "+v(e.name),1),e.selected?(b(),y(i,{key:1,type:"warning",size:"mini",loading:e.loading,onClick:o=>t.deleteMoneyInfo(e)},{default:L((()=>[B])),_:2},1032,["loading","onClick"])):(b(),y(i,{key:0,type:"primary",size:"mini",loading:e.loading,onClick:o=>t.showConfirm(e)},{default:L((()=>[P])),_:2},1032,["loading","onClick"]))])):j("",!0)])))),128))]),p(d,{show:e.typeConfirmVisible,"onUpdate:show":o[2]||(o[2]=o=>e.typeConfirmVisible=o),actions:e.typeActions,"cancel-text":"取消","close-on-click-action":"",onSelect:t.createMoneyInfo,title:"选择理财类型"},null,8,["show","actions","onSelect"])])}));w.render=_,w.__scopeId="data-v-59bd4ff9";export default w;
