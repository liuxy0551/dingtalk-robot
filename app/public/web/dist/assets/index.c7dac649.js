var e=Object.defineProperty,o=Object.defineProperties,n=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,i=(o,n,t)=>n in o?e(o,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[n]=t;import{a as l}from"./index.87ffface.js";import{n as r,o as d,t as c,T as f,D as m,r as y,c as p,d as I,F as g,q as h,w as u,p as v,a as C,b,s as w,v as j,e as S}from"./vendor.cb03d5aa.js";/* empty css              */const k={setup(){const e=localStorage.getItem("senderId"),y=localStorage.getItem("moneyInfoCodes"),p=r({typeConfirmVisible:!1,typeActions:[{name:"基金",value:"jijin"},{name:"股票",value:"gupiao"}],moneyInfo:null,keyword:"",result:[],moneyInfoCodeList:[],refreshing:!1});d((()=>{y&&(p.moneyInfoCodeList=y.split(","))}));return I=((e,o)=>{for(var n in o||(o={}))a.call(o,n)&&i(e,n,o[n]);if(t)for(var n of t(o))s.call(o,n)&&i(e,n,o[n]);return e})({senderId:e},c(p)),o(I,n({onSearch:e=>{l.get(`/api/getMoneyInfoBySina?key=${e}`).then((e=>{e.data.split(";")[0].length<25&&(p.result=[],f("查无结果"));let o=[];e.data.split(";").forEach((e=>{e=e.split(","),o.push({code:e[3],codeB:e[2],name:e[6],selected:p.moneyInfoCodeList.includes(e[2])||p.moneyInfoCodeList.includes(e[3]),loading:!1})})),p.result=o}))},showConfirm:e=>{p.moneyInfo=e,p.typeConfirmVisible=!0},createMoneyInfo:o=>{p.moneyInfo.loading=!0;const n={senderId:e,type:o.value,name:p.moneyInfo.name,code:p.moneyInfo["jijin"===o.value?"codeB":"code"],sort:p.moneyInfoCodeList.length};l.post("/api/createMoneyInfo",n).then((()=>{p.moneyInfoCodeList.push(n.code),localStorage.setItem("moneyInfoCodes",p.moneyInfoCodeList.join(",")),f("添加成功"),p.moneyInfo.selected=!0})).finally((()=>{p.moneyInfo.loading=!1}))},deleteMoneyInfo:o=>{o.loading=!0,m.confirm({title:"删除自选",message:"确认删除该自选理财信息吗？"}).then((()=>{const n=p.moneyInfoCodeList.some((e=>e===o.code)),t={senderId:e,code:o[n?"code":"codeB"]};l.post("/api/deleteMoneyInfo",t).then((()=>{p.moneyInfoCodeList.splice(p.moneyInfoCodeList.indexOf(o[n?"code":"codeB"]),1),localStorage.setItem("moneyInfoCodes",p.moneyInfoCodeList.join(",")),f("删除成功"),o.selected=!1})).finally((()=>{o.loading=!1}))})).catch((()=>{o.loading=!1}))},refreshAPP:()=>{p.refreshing=!0,localStorage.removeItem("versionShow"),location.reload(),setTimeout((()=>{p.refreshing=!1}),2500)}}));var I}},L=u();v("data-v-080738a8");const P={class:"money-content"},O={class:"top-search"},x={class:"box"},V={key:0,class:"row"},M={class:"text"},A=S("添加自选"),B=S("删除自选");C();const _=L(((e,o,n,t,a,s)=>{const i=y("van-search"),l=y("van-button"),r=y("van-icon"),d=y("van-action-sheet");return b(),p("div",P,[I("div",O,[I(i,{modelValue:e.keyword,"onUpdate:modelValue":[o[1]||(o[1]=o=>e.keyword=o),t.onSearch],placeholder:"请输入简称/拼音/代码",onSearch:t.onSearch},null,8,["modelValue","onSearch","onUpdate:modelValue"])]),I("div",x,[(b(!0),p(g,null,h(e.result,(e=>(b(),p("div",{class:"item",key:e.code},[e.code&&e.name?(b(),p("div",V,[I("div",M,w(e.code)+" - "+w(e.name),1),e.selected?(b(),p(l,{key:1,type:"warning",size:"mini",loading:e.loading,onClick:o=>t.deleteMoneyInfo(e)},{default:L((()=>[B])),_:2},1032,["loading","onClick"])):(b(),p(l,{key:0,type:"primary",size:"mini",loading:e.loading,onClick:o=>t.showConfirm(e)},{default:L((()=>[A])),_:2},1032,["loading","onClick"]))])):j("",!0)])))),128))]),I("div",{class:["refresh-box",{loading:e.refreshing}],onClick:o[2]||(o[2]=(...e)=>t.refreshAPP&&t.refreshAPP(...e))},[I(r,{name:"replay"})],2),I(d,{show:e.typeConfirmVisible,"onUpdate:show":o[3]||(o[3]=o=>e.typeConfirmVisible=o),actions:e.typeActions,"cancel-text":"取消","close-on-click-action":"",onSelect:t.createMoneyInfo,title:"选择理财类型"},null,8,["show","actions","onSelect"])])}));k.render=_,k.__scopeId="data-v-080738a8";export default k;
